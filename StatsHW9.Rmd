---
title: "Stats HW#9"
author: "Vishesh Saharan"
date: "4/29/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

###Problem 5.16c
```{r}
MathAnxiety<-read.csv("http://people.kzoo.edu/enordmoe/math365/data/MathAnxiety.csv")
MaleAMAS<-subset(MathAnxiety,select=AMAS,subset=Gender=="Boy",drop=T)
FemaleAMAS<-subset(MathAnxiety,select=AMAS,susbet=Gender=="Girl",drop=T)
n.MaleAMAS <- length(MaleAMAS)
n.FemaleAMAS <- length(FemaleAMAS)

N <- 10^4
diff <- numeric(N)

#set.seed(100)
for (i in 1:N)
{
  x.MaleAMAS <- sample(MaleAMAS, n.MaleAMAS, replace = TRUE)
  x.FemaleAMAS <- sample(FemaleAMAS, n.FemaleAMAS, replace = TRUE)
diff[i] <- mean(x.MaleAMAS) - mean(x.FemaleAMAS)
}

hist(diff, main = "Bootstrap distribution of difference in means",
    xlab = "difference in means")
abline(v = mean(diff),col = "red")
abline(v = mean(MaleAMAS) - mean(FemaleAMAS),
     col = "blue")


qqnorm(diff)
qqline(diff)

mean(diff)
sd(diff)
mean(diff)-(mean(MaleAMAS)-mean(FemaleAMAS))
quantile(diff, c(0.025,0.975))
bias<-mean(diff)-(mean(MaleAMAS)-mean(FemaleAMAS))
bias/sd(diff)
```
The bootstrap estimate of error is 0.021, which represents 2.1% of the bootstrap standard error.

###Problem 5.16d
```{r}
AMAS<-subset(MathAnxiety,select=AMAS,drop=T)

observed <- mean(FemaleAMAS) - mean(MaleAMAS)
N <- 10^4-1
result <- numeric(N)
for (i in 1:N)
 {
  index <- sample(922,323,replace = FALSE)
  result[i] <- mean(AMAS[index]) - mean(AMAS[-index])
}


(sum(result <= observed)+1)/(N+1)
```
I would love to answer the question, but I keep getting NA. Please tell me what is wrong with my code. 

###Problem 5.18a
```{r}
Grocery<-read.csv("http://people.kzoo.edu/enordmoe/math365/data/Groceries.csv")
hist(Grocery$Target)
hist(Grocery$Walmart)
summary(Grocery$Target)
summary(Grocery$Walmart)
qqnorm(Grocery$Target)
qqnorm(Grocery$Walmart)
qqline(Grocery$Target)
qqline(Grocery$Walmart)
```

```{r}
n.Target <- length(Grocery$Target)
n.Walmart <- length(Grocery$Walmart)

N <- 10^4
diff <- numeric(N)

#set.seed(100)
for (i in 1:N)
{
  x.Target <- sample(Grocery$Target, n.Target, replace = TRUE)
  x.Walmart <- sample(Grocery$Walmart, n.Walmart, replace = TRUE)
diff[i] <- mean(x.Target) - mean(x.Walmart)
}

hist(diff)
abline(v = mean(diff),col = "red")
abline(v = mean(Grocery$Target) - mean(Grocery$Walmart),
     col = "blue")


qqnorm(diff)
qqline(diff)

mean(diff)
sd(diff)
quantile(diff, c(0.025,0.975))
```

```{r}
hist(Grocery$Target-Grocery$Walmart)
```

Difference between the two stores on the Quaker Oats Life Cereal is nearly $3, which makes it a heavy outlier compared to the other products. 

```{r}
NewGrocery<-Grocery[-2,c(1:4)]
n.Target <- length(NewGrocery$Target)
n.Walmart <- length(NewGrocery$Walmart)

N <- 10^4
diff <- numeric(N)

#set.seed(100)
for (i in 1:N)
{
  x.Target <- sample(NewGrocery$Target, n.Target, replace = TRUE)
  x.Walmart <- sample(NewGrocery$Walmart, n.Walmart, replace = TRUE)
diff[i] <- mean(x.Target) - mean(x.Walmart)
}

hist(diff)
abline(v = mean(diff),col = "red")
abline(v = mean(NewGrocery$Target) - mean(NewGrocery$Walmart),
     col = "blue")


qqnorm(diff)
qqline(diff)

mean(diff)
sd(diff)
quantile(diff, c(0.025,0.975))
hist(NewGrocery$Target-NewGrocery$Walmart)
```
Without that outlier, it appears to have a more central and normal distribution. 

###Problem 5.22
```{r}
FlightDelay<-read.csv("http://people.kzoo.edu/enordmoe/math365/data/FlightDelays.csv")
AmericanDelay<-subset(FlightDelay,select=Delay,subset=Carrier=="AA",drop=T)
UnitedDelay<-subset(FlightDelay,select=Delay,subset=Carrier=="UA",drop=T)
Delay1<-subset(FlightDelay,select=Delay,drop=T)
hist(AmericanDelay)
hist(UnitedDelay)
summary(AmericanDelay)
summary(UnitedDelay)
qqnorm(AmericanDelay)
qqnorm(UnitedDelay)
qqline(AmericanDelay)
qqline(UnitedDelay)
```

```{r}
(n <- length(AmericanDelay))
N <- 10^4
American.mean <- numeric(N)
for (i in 1:N)
 {
   x <- sample(AmericanDelay, n, replace = TRUE)
   American.mean[i] <- mean(x)
 }

hist(American.mean, main = "Bootstrap distribution of means")
abline(v = mean(AmericanDelay), col = "blue", lty = 2)
                            # vertical line at observed mean

hist(American.mean, main = "Bootstrap distribution of means", breaks = 30)
abline(v = mean(AmericanDelay), col = "blue", lty = 2)
                            # vertical line at observed mean

qqnorm(American.mean)
qqline(American.mean)
summary(American.mean)

(se <- sd(American.mean))
```
Normal distribution. Summary stats coded above

```{r}
(m <- length(UnitedDelay))
N <- 10^4
United.mean <- numeric(N)
for (i in 1:N)
 {
   x <- sample(UnitedDelay, m, replace = TRUE)
   United.mean[i] <- mean(x)
 }

hist(United.mean, main = "Bootstrap distribution of means")
abline(v = mean(UnitedDelay), col = "blue", lty = 2)
                            # vertical line at observed mean

hist(United.mean, main = "Bootstrap distribution of means", breaks = 30)
abline(v = mean(UnitedDelay), col = "blue", lty = 2)
                            # vertical line at observed mean
hist(United.mean)
qqnorm(United.mean)
qqline(United.mean)
summary(United.mean)
(se <- sd(United.mean))
```
Normal distribution. Summary stats coded above

```{r}
B<-10^4

Mean.boot <- numeric(B)
#set.seed(100)
for (i in 1:B)
{
  American.boot <- sample(AmericanDelay, n, replace = TRUE)
  United.boot <- sample(UnitedDelay, m, replace = TRUE)
  Mean.boot[i] <- mean(American.boot)/mean(United.boot)
}

hist(Mean.boot, main = "Bootstrap distribution of ratio of means",xlab="Ratio of Means")
abline(v = mean(Mean.boot), col = "red")
abline(v = mean(AmericanDelay)/mean(UnitedDelay), col = "blue")

hist(Mean.boot)
sd(Mean.boot)
qqnorm(Mean.boot)
qqline(Mean.boot)
quantile(Mean.boot, c(.025, .975)) 
```
Find that it is slightly skewed to the right. With 95% confidence, the mean of American flights delayed is 0.5-0.79 times that of the mean of United flights delayed


```{r}
bias<-mean(Mean.boot)-(mean(AmericanDelay)/mean(UnitedDelay))
bias/sd(Mean.boot)
```
The bootstrap estimate of error is 0.064, which represents 6.4% of the bootstrap standard error. 

Yes, the observations are independent of each other, as the means of each carrier's delays follows a normal distribution. 

